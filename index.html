<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paul OS - Liquid Motion</title>
    <style>
        /* --- SYSTEM RESET & FONTS --- */
        * { box-sizing: border-box; user-select: none; }
        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #000; color: white;
        }

        /* --- WALLPAPER --- */
        .wallpaper {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            /* Wallpaper Sumire Blue Archive */
            background: url('https://server.wallpaperalchemy.com/storage/wallpapers/117/sumire-from-blue-archive-4k-wallpaper.jpeg') no-repeat center center;
            background-size: cover;
            z-index: 0;
        }
        .wallpaper::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.15); pointer-events: none;
        }

        /* Glassmorphism Utility */
        .glass {
            background: rgba(20, 20, 30, 0.65);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        /* --- SCREENS --- */
        .screen {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10;
        }
        
        /* BIOS & BOOT */
        #bios-screen { display: flex; background: #000; color: #38ef7d; font-family: 'Courier New', monospace; padding: 20px; font-size: 14px; z-index: 20000; align-items: flex-start; justify-content: flex-start; }
        #boot-screen { background: #000; z-index: 19000; }
        .logo-spin { width: 90px; height: 90px; border: 4px solid rgba(255,255,255,0.1); border-top: 4px solid #ff9a9e; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* LOCKSCREEN */
        #lock-screen { color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.5); z-index: 18000; transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        
        /* DESKTOP UI */
        #desktop-screen { display: none; z-index: 100; }
        
        /* Top Bar */
        .top-bar {
            position: absolute; top: 0; left: 0; width: 100%; height: 32px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; font-size: 13px; color: white;
            background: rgba(0,0,0,0.2); backdrop-filter: blur(20px);
            z-index: 500; border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        /* Dock */
        .dock-container {
            position: absolute; bottom: 20px; width: 100%;
            display: flex; justify-content: center;
            z-index: 9999; pointer-events: none;
        }
        .dock { 
            display: flex; gap: 15px; padding: 12px 25px; border-radius: 24px; 
            transition: 0.3s; pointer-events: auto;
        }
        
        .app-icon {
            width: 55px; height: 55px; border-radius: 14px;
            display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative;
        }
        .app-icon:hover { transform: scale(1.2) translateY(-15px); margin: 0 8px; z-index: 10000; }
        .app-icon:active { transform: scale(0.9); }
        
        /* Dot indicator for open apps */
        .app-dot {
            position: absolute; bottom: -8px; width: 5px; height: 5px; 
            background: rgba(255,255,255,0.8); border-radius: 50%; display: none;
        }
        .app-icon.active .app-dot { display: block; }

        /* Icon Styles */
        .icon-start { background: linear-gradient(135deg, #ff9a9e, #fecfef); color: white; }
        .icon-files { background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; }
        .icon-terminal { background: linear-gradient(135deg, #434343, #000000); color: #0f0; border: 1px solid #333; }
        .icon-browser { background: linear-gradient(135deg, #4285F4, #34A853); color: white; }
        .icon-note { background: linear-gradient(135deg, #f6d365, #fda085); color: #333; }

        /* Start Menu */
        #start-menu {
            position: absolute; bottom: 110px; left: 50%; transform: translateX(-50%) scale(0.9);
            width: 400px; height: 450px; border-radius: 20px; display: none; flex-direction: column;
            padding: 25px; opacity: 0; 
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); /* Apple ease */
            z-index: 10000;
        }
        #start-menu.open { display: flex; opacity: 1; transform: translateX(-50%) scale(1); }
        .start-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 20px;}
        
        /* --- WINDOW MANAGER ANIMATIONS & STYLE --- */
        .window {
            position: absolute; width: 640px; height: 480px; border-radius: 12px;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 25px 60px rgba(0,0,0,0.6); min-width: 300px; min-height: 200px;
            border: 1px solid rgba(255,255,255,0.2);
            /* CRITICAL: Smooth transition for maximize/restore */
            transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease; 
            transform-origin: center center;
        }
        
        /* Animation Classes */
        .win-opening { animation: popIn 0.4s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        .win-closing { animation: popOut 0.3s forwards; pointer-events: none; }
        .win-minimized { 
            transform: scale(0.5) translateY(500px) !important; 
            opacity: 0 !important; 
            pointer-events: none;
        }

        @keyframes popIn { from { transform: scale(0.9) translateY(20px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }
        @keyframes popOut { from { transform: scale(1); opacity: 1; } to { transform: scale(0.9); opacity: 0; } }

        .window-header {
            height: 38px; background: rgba(255,255,255,0.08); display: flex; align-items: center; padding: 0 14px; 
            cursor: grab; border-bottom: 1px solid rgba(255,255,255,0.1);
            user-select: none;
        }
        .window-header:active { cursor: grabbing; }
        
        .win-controls { display: flex; gap: 8px; margin-right: 15px; }
        .win-btn { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; position: relative; transition: 0.2s; }
        .win-btn:hover { filter: brightness(0.8); }
        
        /* Controls Colors */
        .close { background: #ff5f56; } 
        .min { background: #ffbd2e; } 
        .max { background: #27c93f; }

        /* Hover Symbols (Mac Style) */
        .win-controls:hover .close::after { content: '√ó'; position: absolute; top:-1px; left:2px; font-size:10px; color:rgba(0,0,0,0.6); font-weight:800; }
        .win-controls:hover .min::after { content: '-'; position: absolute; top:-2px; left:3px; font-size:10px; color:rgba(0,0,0,0.6); font-weight:800; }
        .win-controls:hover .max::after { content: '+'; position: absolute; top:-1px; left:2px; font-size:10px; color:rgba(0,0,0,0.6); font-weight:800; }

        .win-title { flex-grow: 1; text-align: center; font-size: 13px; color: #fff; pointer-events: none; font-weight: 500; opacity: 0.9; }
        
        .window-content { flex-grow: 1; background: rgba(30, 30, 40, 0.95); color: white; position: relative; display: flex; flex-direction: column; }
        
        /* Content Specifics */
        .avatar-img {
            width: 90px; height: 90px; border-radius: 50%; margin: 0 auto 15px auto;
            background-color: #fff;
            background-image: url('https://api.dicebear.com/9.x/micah/svg?seed=Amia&backgroundColor=ffdfbf'); 
            background-size: cover;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .photo-view-container { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; padding: 10px; background: #000; }
        .photo-view-container img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .file-item { display: flex; flex-direction: column; align-items: center; padding: 15px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .file-item:hover { background: rgba(255,255,255,0.2); }

    </style>
</head>
<body>

    <div id="bios-screen" class="screen">
        <div id="bios-text"></div>
    </div>

    <div id="boot-screen" class="screen">
        <div class="logo-spin"></div>
        <h3>Paul OS</h3>
        <p style="opacity: 0.7; font-size: 0.9rem;">Loading Amia's Workspace...</p>
    </div>

    <div id="lock-screen" class="screen glass">
        <div id="lock-clock">00:00</div>
        <div style="font-size: 1.2rem; margin-bottom: 50px;" id="lock-date">Sunday, November 23</div>
        
        <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 25px; backdrop-filter: blur(15px); text-align: center; border: 1px solid rgba(255,255,255,0.2);">
            <div class="avatar-img"></div>
            <h3 style="margin: 0 0 20px 0; font-weight: 600;">Amia</h3>
            <button style="padding: 10px 35px; border-radius: 20px; border: none; background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: white; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: transform 0.2s;" onclick="unlockSystem()" onmousedown="this.style.transform='scale(0.95)'" onmouseup="this.style.transform='scale(1)'">Login</button>
        </div>
    </div>

    <div id="desktop-screen" class="screen">
        <div class="wallpaper"></div>

        <div class="top-bar">
            <div style="display: flex; gap:15px; font-weight: 600; align-items: center;">
                <span>üíé Paul OS</span>
                <span style="font-weight: normal; opacity: 0.8;">File</span>
                <span style="font-weight: normal; opacity: 0.8;">Edit</span>
                <span style="font-weight: normal; opacity: 0.8;">View</span>
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <span>üîã 100%</span>
                <span>üì∂ WiFi</span>
                <span id="status-bar-clock">12:00 PM</span>
            </div>
        </div>

        <div id="window-area" style="position: absolute; top: 32px; bottom: 0; width: 100%; pointer-events: none;">
            </div>

        <div id="start-menu" class="glass">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
                <div style="width: 45px; height: 45px; background-color: white; border-radius: 50%; background-image: url('https://api.dicebear.com/9.x/micah/svg?seed=Amia&backgroundColor=ffdfbf'); background-size: cover;"></div>
                <div>
                    <div style="font-size: 16px; font-weight: bold;">Amia</div>
                    <div style="font-size: 11px; opacity: 0.7;">Administrator</div>
                </div>
            </div>
            <div class="start-grid">
                <div class="app-icon icon-files" onclick="launchApp('explorer')">üìÇ</div>
                <div class="app-icon icon-terminal" onclick="launchApp('terminal')">üíª</div>
                <div class="app-icon icon-browser" onclick="launchApp('browser')">üåê</div>
                <div class="app-icon icon-note" onclick="launchApp('notepad')">üìù</div>
            </div>
            <div style="margin-top: auto; display: flex; justify-content: center;">
                <button onclick="location.reload()" style="background: rgba(255, 95, 86, 0.8); border: none; padding: 10px 25px; border-radius: 12px; color: white; cursor: pointer; font-weight: 500; width: 100%;">Shut Down</button>
            </div>
        </div>

        <div class="dock-container">
            <div class="dock glass">
                <div class="app-icon icon-start" onclick="toggleStartMenu()" title="Start Menu">üíé</div>
                <div class="app-icon icon-files" id="dock-explorer" onclick="launchApp('explorer')" title="Files">üìÇ<div class="app-dot"></div></div>
                <div class="app-icon icon-terminal" id="dock-terminal" onclick="launchApp('terminal')" title="Terminal">üíª<div class="app-dot"></div></div>
                <div class="app-icon icon-browser" id="dock-browser" onclick="launchApp('browser')" title="Browser">üåê<div class="app-dot"></div></div>
                <div class="app-icon icon-note" id="dock-notepad" onclick="launchApp('notepad')" title="Notepad">üìù<div class="app-dot"></div></div>
            </div>
        </div>
    </div>

    <script>
        /* --- SYSTEM LOGIC --- */
        
        // 1. BIOS
        const biosLines = [
            "PAUL OS BIOS v2.5 [Liquid Motion]",
            "CPU: 100% | RAM: 100%",
            "Loading GPU Acceleration...",
            "System Ready."
        ];

        function runBios() {
            const biosScreen = document.getElementById('bios-screen');
            const biosText = document.getElementById('bios-text');
            biosScreen.style.display = 'flex';
            let lineIndex = 0;
            function typeLine() {
                if(lineIndex < biosLines.length) {
                    const p = document.createElement('div');
                    p.textContent = biosLines[lineIndex];
                    p.style.marginBottom = "5px";
                    biosText.appendChild(p);
                    lineIndex++;
                    setTimeout(typeLine, 150);
                } else {
                    setTimeout(() => { biosScreen.style.display = 'none'; runBoot(); }, 500);
                }
            }
            typeLine();
        }

        // 2. Boot
        function runBoot() {
            const bootScreen = document.getElementById('boot-screen');
            bootScreen.style.display = 'flex';
            setTimeout(() => { bootScreen.style.display = 'none'; showLockScreen(); }, 1200);
        }

        // 3. Lock Screen
        function showLockScreen() {
            const lockScreen = document.getElementById('lock-screen');
            lockScreen.style.display = 'flex';
            updateClock();
        }

        function unlockSystem() {
            const lockScreen = document.getElementById('lock-screen');
            lockScreen.style.opacity = "0";
            lockScreen.style.transform = "scale(1.1)";
            lockScreen.style.filter = "blur(20px)";
            setTimeout(() => {
                lockScreen.style.display = 'none';
                document.getElementById('desktop-screen').style.display = 'block';
            }, 600);
        }

        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const mins = String(now.getMinutes()).padStart(2, '0');
            const timeStr = `${hours}:${mins}`;
            
            const lockClock = document.getElementById('lock-clock');
            if(lockClock) lockClock.innerText = timeStr;
            const statusClock = document.getElementById('status-bar-clock');
            if(statusClock) statusClock.innerText = timeStr + (now.getHours() >= 12 ? ' PM' : ' AM');
        }
        setInterval(updateClock, 1000);

        // --- WINDOW MANAGER LOGIC ---
        let zIndexCounter = 100;
        const windowArea = document.getElementById('window-area');
        // Track open windows to enable restore from dock
        const appInstances = {}; 

        function toggleStartMenu() {
            const menu = document.getElementById('start-menu');
            menu.classList.toggle('open');
        }

        // MAIN LAUNCH FUNCTION
        function launchApp(appType, extraData = null) {
            document.getElementById('start-menu').classList.remove('open');

            // Check if app is already open (for single instance apps behavior simulation)
            // Exception: 'viewer' (images) can open multiple
            if (appInstances[appType] && appType !== 'viewer') {
                restoreWindow(appInstances[appType]);
                return;
            }

            createWindow(appType, extraData);
        }

        function createWindow(appType, extraData) {
            const win = document.createElement('div');
            win.className = 'window glass win-opening';
            win.style.zIndex = ++zIndexCounter;
            win.style.pointerEvents = 'auto';
            
            // Random position
            const rX = 50 + Math.random() * 50;
            const rY = 50 + Math.random() * 50;
            win.style.left = `calc(50% - 320px + ${rX}px)`;
            win.style.top = `calc(50% - 240px + ${rY}px)`;

            // Store original dimensions for restore
            win.dataset.w = '640px';
            win.dataset.h = '480px';

            let title = "App";
            let content = "";

            // Content Switch
            switch(appType) {
                case 'terminal':
                    title = "Terminal";
                    content = `<div style="padding:15px; font-family:monospace; color:#38ef7d; font-size:14px; overflow:auto; height:100%;">
                        <div>amia@paul-os:~# sys_status</div>
                        <div>> All systems operational.</div>
                        <div>> Animation engine: Smooth</div>
                        <br>
                        <div>amia@paul-os:~# <span style="animation:blinker 1s infinite">_</span></div>
                        <style>@keyframes blinker{50%{opacity:0}}</style>
                    </div>`;
                    break;
                case 'explorer':
                    title = "File Explorer";
                    content = `<div id="exp-${zIndexCounter}" style="display:flex; flex-wrap:wrap; padding:15px; gap:15px; overflow:auto; height:100%;"></div>`;
                    setTimeout(() => renderFiles(`exp-${zIndexCounter}`, 'root'), 50);
                    break;
                case 'viewer':
                    title = "Image Viewer";
                    content = `<div class="photo-view-container"><img src="${extraData}"></div>`;
                    break;
                case 'browser':
                    title = "Google Chrome";
                    content = `
                    <div style="display:flex; flex-direction:column; height:100%; background:white;">
                        <div style="padding:8px; border-bottom:1px solid #ccc; background:#f1f1f1; display:flex; gap:10px; align-items:center;">
                           <div style="color:#555; font-size:14px; cursor:pointer;">‚ùÆ</div>
                           <div style="color:#555; font-size:14px; cursor:pointer;">‚ùØ</div>
                           <input type="text" value="https://www.google.com" style="flex-grow:1; border-radius:20px; border:1px solid #ddd; padding:4px 15px; font-size:13px; color:#333; background:#fff;" disabled>
                        </div>
                        <iframe src="https://www.google.com/webhp?igu=1" style="flex-grow:1; border:none; width:100%; height:100%;"></iframe>
                    </div>`;
                    break;
                case 'notepad':
                    title = "Notepad";
                    content = `<textarea style="width:100%; height:100%; background:transparent; border:none; color:white; padding:20px; outline:none; resize:none; font-family:sans-serif; font-size:15px; line-height:1.5;" placeholder="Write something..."></textarea>`;
                    break;
            }

            win.innerHTML = `
                <div class="window-header" ondblclick="maximizeWindow(this.querySelector('.max'))" onmousedown="dragMouseDown(event, this.parentElement)">
                    <div class="win-controls">
                        <div class="win-btn close" onclick="closeWindow(this)"></div>
                        <div class="win-btn min" onclick="minimizeWindow(this)"></div>
                        <div class="win-btn max" onclick="maximizeWindow(this)"></div>
                    </div>
                    <div class="win-title">${title}</div>
                </div>
                <div class="window-content">${content}</div>
            `;
            
            // Bring to front
            win.onmousedown = function() { this.style.zIndex = ++zIndexCounter; };
            
            windowArea.appendChild(win);
            
            // Register App Instance
            if(appType !== 'viewer') {
                appInstances[appType] = win;
                updateDockIndicator(appType, true);
            }
        }

        // --- WINDOW ACTIONS ---

        function closeWindow(btn) {
            const win = btn.closest('.window');
            win.classList.add('win-closing');
            
            // Remove from registry
            for (const [key, val] of Object.entries(appInstances)) {
                if (val === win) {
                    delete appInstances[key];
                    updateDockIndicator(key, false);
                }
            }
            setTimeout(() => win.remove(), 300);
        }

        function minimizeWindow(btn) {
            const win = btn.closest('.window');
            win.classList.add('win-minimized'); // CSS handles the transition
        }

        function restoreWindow(win) {
            // Remove minimized state
            win.classList.remove('win-minimized');
            // Bring to front
            win.style.zIndex = ++zIndexCounter;
            // Visual shake to indicate attention
            win.style.transform = 'scale(1.02)';
            setTimeout(() => win.style.transform = 'scale(1)', 200);
        }

        function maximizeWindow(btn) {
            const win = btn.closest('.window');
            
            if (win.classList.contains('is-maximized')) {
                // RESTORE
                win.classList.remove('is-maximized');
                win.style.top = win.dataset.oldTop;
                win.style.left = win.dataset.oldLeft;
                win.style.width = win.dataset.oldWidth;
                win.style.height = win.dataset.oldHeight;
                win.style.borderRadius = '12px';
            } else {
                // MAXIMIZE
                // Save state
                win.dataset.oldTop = win.style.top;
                win.dataset.oldLeft = win.style.left;
                win.dataset.oldWidth = win.style.width;
                win.dataset.oldHeight = win.style.height;
                
                win.classList.add('is-maximized');
                
                // Apply Full Screen (minus top bar and dock gap)
                win.style.top = '32px'; // Below top bar
                win.style.left = '0';
                win.style.width = '100%';
                win.style.height = 'calc(100% - 80px)'; // Leave room for dock
                win.style.borderRadius = '0';
                win.style.transform = 'translate(0,0)'; // Reset any transforms
            }
        }

        function updateDockIndicator(appType, isActive) {
            const icon = document.getElementById('dock-' + appType);
            if(icon) {
                if(isActive) icon.classList.add('active');
                else icon.classList.remove('active');
            }
        }

        // --- FILE SYSTEM ---
        const fileSystem = {
            root: [
                { name: "Wallpapers", type: "folder", target: "walls", icon: "üñºÔ∏è" },
                { name: "Diary", type: "folder", target: "secrets", icon: "üìî" },
                { name: "About.txt", type: "file", icon: "üìÑ" }
            ],
            walls: [
                { name: "Back", type: "back", target: "root", icon: "‚¨ÖÔ∏è" },
                { name: "Anime_1.jpg", type: "image", src: "https://images.unsplash.com/photo-1578632767115-351597cf2477?w=800", icon: "üñºÔ∏è" },
                { name: "City.jpg", type: "image", src: "https://images.unsplash.com/photo-1607604276583-eef5d076aa5f?w=800", icon: "üñºÔ∏è" }
            ],
            secrets: [
                 { name: "Back", type: "back", target: "root", icon: "‚¨ÖÔ∏è" },
                 { name: "Secret.txt", type: "file", icon: "üîí" }
            ]
        };

        function renderFiles(containerId, folderKey) {
            const container = document.getElementById(containerId);
            if(!container) return;
            container.innerHTML = '';
            
            fileSystem[folderKey].forEach(item => {
                const el = document.createElement('div');
                el.className = 'file-item';
                el.innerHTML = `<div style="font-size:40px; margin-bottom:5px;">${item.icon}</div><div style="font-size:12px; text-align:center;">${item.name}</div>`;
                el.onclick = () => {
                    if(item.type === 'folder' || item.type === 'back') renderFiles(containerId, item.target);
                    else if(item.type === 'image') createWindow('viewer', item.src);
                };
                container.appendChild(el);
            });
        }

        // --- DRAGGING ---
        function dragMouseDown(e, elmnt) {
            // Prevent drag if maximized
            if(elmnt.classList.contains('is-maximized')) return;
            
            e = e || window.event;
            e.preventDefault();
            let pos3 = e.clientX;
            let pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                let pos1 = pos3 - e.clientX;
                let pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
            }
            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        window.onload = runBios;
    </script>
</body>
</html>
